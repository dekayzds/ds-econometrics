[{"path":"index.html","id":"welcome","chapter":"Welcome","heading":"Welcome","text":"code version Application Econometric Models RStudio, book released 2023 IPB Press. book written Muhammad Firdaus, Tony Irawan, Fahmi Salam Ahmad, Hermanto Siregar, Deri Siswara, Rodi Jakariya. can order full version , includes detailed explanations.book aims help students researchers apply econometric models analysis using RStudio software. begins introduction use R programming language RStudio IDE. book covers topics theory application OLS models, including testing Gauss-Markov conditions. Additionally, presents application time-series models ARMA, GARCH, VAR, VECM, ARDL, SVAR., static dynamic panel data analysis using RStudio’s instruments accommodate heteroscedasticity autocorrelation assumptions. Finally, discussion spatial model applications analysis spatial regional elements. latest publication update includes three additional chapters: spillover analysis time series data; DCC-GARCH; Non-linear ARDL. Updates made frequently.book may contain bugs/errors readers can report Buku.rstudio.ipb@gmail.com","code":""},{"path":"basics-of-r.html","id":"basics-of-r","chapter":"1 Basics of R","heading":"1 Basics of R","text":"","code":""},{"path":"basics-of-r.html","id":"introduction","chapter":"1 Basics of R","heading":"1.1 Introduction","text":"","code":"\nA <- 2  \nA # Print A\n#> [1] 2\nA = 2\nA\n#> [1] 2\nB <- \"Halo Semua\"\nB\n#> [1] \"Halo Semua\"\na<-10 # Space is not sensitive but lettercase is sensitive.\nA\n#> [1] 2\na\n#> [1] 10\n# Arithmetic operation\nx <- 5\ny <- 3\nx + y     \n#> [1] 8\nx - y     \n#> [1] 2\nx * y     \n#> [1] 15\nx / y     \n#> [1] 1.666667\n# Logic operation\na <- TRUE\nb <- FALSE\na & b     \n#> [1] FALSE\na | b     \n#> [1] TRUE\n!a        \n#> [1] FALSE\nx <- 5\ny <- 3\nx > y     \n#> [1] TRUE\nx < y     \n#> [1] FALSE\nx == y    \n#> [1] FALSE\nx >= y    \n#> [1] TRUE\nx <= y    \n#> [1] FALSE"},{"path":"basics-of-r.html","id":"types-of-objects-in-r","chapter":"1 Basics of R","heading":"1.2 Types of Objects in R","text":"","code":""},{"path":"basics-of-r.html","id":"vector","chapter":"1 Basics of R","heading":"1.2.1 Vector","text":"","code":"\na1 <- c(2,4,7,3) # Numeric vector\na2 <- c(\"one\",\"two\",\"three\") # Character vector\na3 <- c(TRUE,TRUE,TRUE,FALSE,TRUE,FALSE) # Logical vector\na1\n#> [1] 2 4 7 3\na3[4]        \n#> [1] FALSE\na2[c(1,3)]   \n#> [1] \"one\"   \"three\"\na1[-1]       \n#> [1] 4 7 3\na1[2:4]      \n#> [1] 4 7 3\na <- c(1, 2, 3)\nb <- c(4, 5, 6)\nc <- c(a, b)      \nc                 \n#> [1] 1 2 3 4 5 6\nc[1:3]            \n#> [1] 1 2 3\nd <- a + b        \nd                 \n#> [1] 5 7 9\na4 <- 1:12 \nb1 <- matrix(a4,3,4)\nb2 <- matrix(a4,3,4,byrow=TRUE) \nb3 <- matrix(1:14,4,4)\n#> Warning in matrix(1:14, 4, 4): data length [14] is not a\n#> sub-multiple or multiple of the number of rows [4]\nb1\n#>      [,1] [,2] [,3] [,4]\n#> [1,]    1    4    7   10\n#> [2,]    2    5    8   11\n#> [3,]    3    6    9   12\nb2\n#>      [,1] [,2] [,3] [,4]\n#> [1,]    1    2    3    4\n#> [2,]    5    6    7    8\n#> [3,]    9   10   11   12\nb3\n#>      [,1] [,2] [,3] [,4]\n#> [1,]    1    5    9   13\n#> [2,]    2    6   10   14\n#> [3,]    3    7   11    1\n#> [4,]    4    8   12    2\nb2[2,3]   \n#> [1] 7\nb2[1:2,]  \n#>      [,1] [,2] [,3] [,4]\n#> [1,]    1    2    3    4\n#> [2,]    5    6    7    8\nb2[c(1,3),-2] \n#>      [,1] [,2] [,3]\n#> [1,]    1    3    4\n#> [2,]    9   11   12\ndim(b2) \n#> [1] 3 4\nm1 <- matrix(c(1, 2, 3, 4, 5, 6), nrow = 2, ncol = 3)\nm2 <- matrix(c(7, 8, 9, 10, 11, 12), nrow = 2, ncol = 3)\nm3 <- m1 + m2\nm3\n#>      [,1] [,2] [,3]\n#> [1,]    8   12   16\n#> [2,]   10   14   18\nm4 <- m1 %*% t(m2)\nm4\n#>      [,1] [,2]\n#> [1,]   89   98\n#> [2,]  116  128"},{"path":"basics-of-r.html","id":"factor","chapter":"1 Basics of R","heading":"1.2.2 Factor","text":"","code":"\na5 <- c(\"A\",\"B\",\"AB\",\"O\")\nd1 <- factor(a5) \nlevels(d1)\n#> [1] \"A\"  \"AB\" \"B\"  \"O\"\nlevels(d1) <- c(\"Darah A\",\"Darah AB\",\"Darah B\",\"Darah O\")\nd1\n#> [1] Darah A  Darah B  Darah AB Darah O \n#> Levels: Darah A Darah AB Darah B Darah O\na6 <- c(\"SMA\",\"SD\",\"SMP\",\"SMA\",\"SMA\",\"SMA\",\"SMA\",\"SMA\",\"SMA\",\"SMA\",\"SMA\",\"SMA\",\"SMA\")\nd5 <- factor(a6, levels=c(\"SD\",\"SMP\",\"SMA\")) # Skala pengukuran ordinal  \nlevels(d5) \n#> [1] \"SD\"  \"SMP\" \"SMA\"\nd5\n#>  [1] SMA SD  SMP SMA SMA SMA SMA SMA SMA SMA SMA SMA SMA\n#> Levels: SD SMP SMA"},{"path":"basics-of-r.html","id":"list","chapter":"1 Basics of R","heading":"1.2.3 List","text":"","code":"\na1; b2; d1\n#> [1] 2 4 7 3\n#>      [,1] [,2] [,3] [,4]\n#> [1,]    1    2    3    4\n#> [2,]    5    6    7    8\n#> [3,]    9   10   11   12\n#> [1] Darah A  Darah B  Darah AB Darah O \n#> Levels: Darah A Darah AB Darah B Darah O\ne1 <- list(a1,b2,d1)\ne2 <- list(vect=a1,mat=b2,fac=d1) \ne1\n#> [[1]]\n#> [1] 2 4 7 3\n#> \n#> [[2]]\n#>      [,1] [,2] [,3] [,4]\n#> [1,]    1    2    3    4\n#> [2,]    5    6    7    8\n#> [3,]    9   10   11   12\n#> \n#> [[3]]\n#> [1] Darah A  Darah B  Darah AB Darah O \n#> Levels: Darah A Darah AB Darah B Darah O\ne2\n#> $vect\n#> [1] 2 4 7 3\n#> \n#> $mat\n#>      [,1] [,2] [,3] [,4]\n#> [1,]    1    2    3    4\n#> [2,]    5    6    7    8\n#> [3,]    9   10   11   12\n#> \n#> $fac\n#> [1] Darah A  Darah B  Darah AB Darah O \n#> Levels: Darah A Darah AB Darah B Darah O\ne1[[1]][2] \n#> [1] 4\ne2$fac \n#> [1] Darah A  Darah B  Darah AB Darah O \n#> Levels: Darah A Darah AB Darah B Darah O\ne2[2] \n#> $mat\n#>      [,1] [,2] [,3] [,4]\n#> [1,]    1    2    3    4\n#> [2,]    5    6    7    8\n#> [3,]    9   10   11   12\nnames(e2)\n#> [1] \"vect\" \"mat\"  \"fac\""},{"path":"basics-of-r.html","id":"data-frame","chapter":"1 Basics of R","heading":"1.2.4 Data Frame","text":"","code":"\nAngka <- 11:15\nHuruf <- factor(LETTERS[6:10])\nf1 <- data.frame(Angka,Huruf)\nf1\n#>   Angka Huruf\n#> 1    11     F\n#> 2    12     G\n#> 3    13     H\n#> 4    14     I\n#> 5    15     J\nf1[1,2] \n#> [1] F\n#> Levels: F G H I J\nf1$Angka \n#> [1] 11 12 13 14 15\nf1[,\"Huruf\"] \n#> [1] F G H I J\n#> Levels: F G H I J\ncolnames(f1) \n#> [1] \"Angka\" \"Huruf\"\nstr(f1)\n#> 'data.frame':    5 obs. of  2 variables:\n#>  $ Angka: int  11 12 13 14 15\n#>  $ Huruf: Factor w/ 5 levels \"F\",\"G\",\"H\",\"I\",..: 1 2 3 4 5"},{"path":"basics-of-r.html","id":"data-frame-management","chapter":"1 Basics of R","heading":"1.3 Data Frame Management","text":"","code":"\ndata(iris) \nhead(iris) \n#>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n#> 1          5.1         3.5          1.4         0.2  setosa\n#> 2          4.9         3.0          1.4         0.2  setosa\n#> 3          4.7         3.2          1.3         0.2  setosa\n#> 4          4.6         3.1          1.5         0.2  setosa\n#> 5          5.0         3.6          1.4         0.2  setosa\n#> 6          5.4         3.9          1.7         0.4  setosa\ntail(iris) \n#>     Sepal.Length Sepal.Width Petal.Length Petal.Width\n#> 145          6.7         3.3          5.7         2.5\n#> 146          6.7         3.0          5.2         2.3\n#> 147          6.3         2.5          5.0         1.9\n#> 148          6.5         3.0          5.2         2.0\n#> 149          6.2         3.4          5.4         2.3\n#> 150          5.9         3.0          5.1         1.8\n#>       Species\n#> 145 virginica\n#> 146 virginica\n#> 147 virginica\n#> 148 virginica\n#> 149 virginica\n#> 150 virginica\nstr(iris)\n#> 'data.frame':    150 obs. of  5 variables:\n#>  $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...\n#>  $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...\n#>  $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...\n#>  $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...\n#>  $ Species     : Factor w/ 3 levels \"setosa\",\"versicolor\",..: 1 1 1 1 1 1 1 1 1 1 ..."},{"path":"basics-of-r.html","id":"r-package","chapter":"1 Basics of R","heading":"1.3.1 R Package","text":"","code":"\n# install.packages(\"readxl\") - code to install R package\nlibrary(readxl)\n#> Warning: package 'readxl' was built under R version 4.2.3\n#install.packages(\"dplyr\")\nlibrary(dplyr)\n#> Warning: package 'dplyr' was built under R version 4.2.3\n#> \n#> Attaching package: 'dplyr'\n#> The following objects are masked from 'package:stats':\n#> \n#>     filter, lag\n#> The following objects are masked from 'package:base':\n#> \n#>     intersect, setdiff, setequal, union"},{"path":"basics-of-r.html","id":"data-management-with-dplyr","chapter":"1 Basics of R","heading":"1.3.2 Data Management With dplyr","text":"","code":"\nhead(iris)\n#>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n#> 1          5.1         3.5          1.4         0.2  setosa\n#> 2          4.9         3.0          1.4         0.2  setosa\n#> 3          4.7         3.2          1.3         0.2  setosa\n#> 4          4.6         3.1          1.5         0.2  setosa\n#> 5          5.0         3.6          1.4         0.2  setosa\n#> 6          5.4         3.9          1.7         0.4  setosa\nirisbaru  <- mutate(iris, sepal2 = Sepal.Length + Sepal.Width)\nhead(irisbaru)\n#>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n#> 1          5.1         3.5          1.4         0.2  setosa\n#> 2          4.9         3.0          1.4         0.2  setosa\n#> 3          4.7         3.2          1.3         0.2  setosa\n#> 4          4.6         3.1          1.5         0.2  setosa\n#> 5          5.0         3.6          1.4         0.2  setosa\n#> 6          5.4         3.9          1.7         0.4  setosa\n#>   sepal2\n#> 1    8.6\n#> 2    7.9\n#> 3    7.9\n#> 4    7.7\n#> 5    8.6\n#> 6    9.3\nirisetosa <- filter(iris, Species==\"setosa\")\nhead(irisetosa)\n#>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n#> 1          5.1         3.5          1.4         0.2  setosa\n#> 2          4.9         3.0          1.4         0.2  setosa\n#> 3          4.7         3.2          1.3         0.2  setosa\n#> 4          4.6         3.1          1.5         0.2  setosa\n#> 5          5.0         3.6          1.4         0.2  setosa\n#> 6          5.4         3.9          1.7         0.4  setosa\nlevels(iris$Species)\n#> [1] \"setosa\"     \"versicolor\" \"virginica\"\nirisversicolor <- filter(iris, Species==\"setosa\"& Petal.Length==1.3)\nhead(irisversicolor)\n#>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n#> 1          4.7         3.2          1.3         0.2  setosa\n#> 2          5.4         3.9          1.3         0.4  setosa\n#> 3          5.5         3.5          1.3         0.2  setosa\n#> 4          4.4         3.0          1.3         0.2  setosa\n#> 5          5.0         3.5          1.3         0.3  setosa\n#> 6          4.5         2.3          1.3         0.3  setosa\niris3 <- select(iris, Sepal.Length, Species)\nhead(iris3)\n#>   Sepal.Length Species\n#> 1          5.1  setosa\n#> 2          4.9  setosa\n#> 3          4.7  setosa\n#> 4          4.6  setosa\n#> 5          5.0  setosa\n#> 6          5.4  setosa\niris4 <- arrange(iris, Petal.Width)\nhead(iris4)\n#>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n#> 1          4.9         3.1          1.5         0.1  setosa\n#> 2          4.8         3.0          1.4         0.1  setosa\n#> 3          4.3         3.0          1.1         0.1  setosa\n#> 4          5.2         4.1          1.5         0.1  setosa\n#> 5          4.9         3.6          1.4         0.1  setosa\n#> 6          5.1         3.5          1.4         0.2  setosa\niris4 <- arrange(iris, Species, desc(Petal.Width))\nhead(iris4)\n#>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n#> 1          5.0         3.5          1.6         0.6  setosa\n#> 2          5.1         3.3          1.7         0.5  setosa\n#> 3          5.4         3.9          1.7         0.4  setosa\n#> 4          5.7         4.4          1.5         0.4  setosa\n#> 5          5.4         3.9          1.3         0.4  setosa\n#> 6          5.1         3.7          1.5         0.4  setosa\nnames(iris4)[1] <- \"length\" \nhead(iris4)\n#>   length Sepal.Width Petal.Length Petal.Width Species\n#> 1    5.0         3.5          1.6         0.6  setosa\n#> 2    5.1         3.3          1.7         0.5  setosa\n#> 3    5.4         3.9          1.7         0.4  setosa\n#> 4    5.7         4.4          1.5         0.4  setosa\n#> 5    5.4         3.9          1.3         0.4  setosa\n#> 6    5.1         3.7          1.5         0.4  setosa\nhead(iris4[,c(-1,-3)])\n#>   Sepal.Width Petal.Width Species\n#> 1         3.5         0.6  setosa\n#> 2         3.3         0.5  setosa\n#> 3         3.9         0.4  setosa\n#> 4         4.4         0.4  setosa\n#> 5         3.9         0.4  setosa\n#> 6         3.7         0.4  setosa\niris %>% group_by(Species) %>% summarise(rata2_Sepal.Width = mean(Sepal.Width))\n#> # A tibble: 3 × 2\n#>   Species    rata2_Sepal.Width\n#>   <fct>                  <dbl>\n#> 1 setosa                  3.43\n#> 2 versicolor              2.77\n#> 3 virginica               2.97"},{"path":"basics-of-r.html","id":"visualization","chapter":"1 Basics of R","heading":"1.4 Visualization","text":"","code":""},{"path":"basics-of-r.html","id":"histogram","chapter":"1 Basics of R","heading":"1.4.1 Histogram","text":"","code":"\nhist(iris$Sepal.Length)"},{"path":"basics-of-r.html","id":"box-plot","chapter":"1 Basics of R","heading":"1.4.2 Box Plot","text":"","code":"\nboxplot(iris$Sepal.Length)"},{"path":"basics-of-r.html","id":"barplot","chapter":"1 Basics of R","heading":"1.4.3 Barplot","text":"","code":"\ntable(iris$Species)\n#> \n#>     setosa versicolor  virginica \n#>         50         50         50\nbarplot(table(iris$Species))"},{"path":"basics-of-r.html","id":"pie-chart","chapter":"1 Basics of R","heading":"1.4.4 Pie Chart","text":"","code":"\npie(table(iris$Species))"},{"path":"basics-of-r.html","id":"scatter-plot","chapter":"1 Basics of R","heading":"1.4.5 Scatter Plot","text":"","code":"\nplot(iris$Sepal.Length,iris$Sepal.Width)\nplot(iris$Sepal.Length, iris$Sepal.Width, main = \"Sepal Length vs. Sepal Width\", \n     xlab = \"Sepal Length\", ylab = \"Sepal Width\", col = \"red\")"},{"path":"spatial-regression.html","id":"spatial-regression","chapter":"2 Spatial Regression","heading":"2 Spatial Regression","text":"","code":""},{"path":"spatial-regression.html","id":"library","chapter":"2 Spatial Regression","heading":"2.1 Library","text":"","code":"\n# install.packages(\"spdep\")\n# install.packages(\"spatialreg\")\n# install.packages(\"RColorBrewer\")\n# install.packages(\"splm\")\n# install.packages(\"sf\")\n# install.packages(\"ggplot2\")\nlibrary(spdep)\n#> Warning: package 'spdep' was built under R version 4.2.3\n#> Loading required package: spData\n#> Warning: package 'spData' was built under R version 4.2.3\n#> To access larger datasets in this package, install\n#> the spDataLarge package with:\n#> `install.packages('spDataLarge',\n#> repos='https://nowosad.github.io/drat/',\n#> type='source')`\n#> Loading required package: sf\n#> Warning: package 'sf' was built under R version 4.2.3\n#> Linking to GEOS 3.9.3, GDAL 3.5.2, PROJ 8.2.1; sf_use_s2()\n#> is TRUE\nlibrary(spatialreg)\n#> Warning: package 'spatialreg' was built under R version\n#> 4.2.3\n#> Loading required package: Matrix\n#> Warning: package 'Matrix' was built under R version 4.2.3\n#> \n#> Attaching package: 'spatialreg'\n#> The following objects are masked from 'package:spdep':\n#> \n#>     get.ClusterOption, get.coresOption, get.mcOption,\n#>     get.VerboseOption, get.ZeroPolicyOption,\n#>     set.ClusterOption, set.coresOption, set.mcOption,\n#>     set.VerboseOption, set.ZeroPolicyOption\nlibrary(RColorBrewer)\nlibrary(splm)\n#> Warning: package 'splm' was built under R version 4.2.3\nlibrary(sf)\nlibrary(ggplot2)\n#> Warning: package 'ggplot2' was built under R version 4.2.3"},{"path":"spatial-regression.html","id":"cross-section","chapter":"2 Spatial Regression","heading":"2.2 Cross-Section","text":"","code":"\nlibrary(readxl)\n#> Warning: package 'readxl' was built under R version 4.2.3\nprovinsi <- read_excel(\"Data/Bab6/provinsi Indonesia.xlsx\")\nhead(provinsi)\n#> # A tibble: 6 × 5\n#>   province    pdrb investment infra revenue\n#>   <chr>      <dbl>      <dbl> <dbl>   <dbl>\n#> 1 Aceh     129093.      4485.  0.37  11694.\n#> 2 Sumut    571722.     21477.  0.52   8481.\n#> 3 Sumbar   179952.      2340.  0.52   4052.\n#> 4 Riau     652762.     18957.  0.28   6911.\n#> 5 Jambi    155066.      5026.  0.26   3130.\n#> 6 Sumsel   331766.     19853.  0.2    5990."},{"path":"spatial-regression.html","id":"ols-model","chapter":"2 Spatial Regression","heading":"2.2.1 OLS Model","text":"","code":"\nmodel1 = log(pdrb) ~ log(investment) + log(infra) + log(revenue)\nols = lm(model1, data=provinsi)\nsummary(ols)\n#> \n#> Call:\n#> lm(formula = model1, data = provinsi)\n#> \n#> Residuals:\n#>      Min       1Q   Median       3Q      Max \n#> -0.82306 -0.33812  0.00604  0.32399  0.83581 \n#> \n#> Coefficients:\n#>                 Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)      3.95883    0.85379   4.637 6.48e-05 ***\n#> log(investment)  0.42187    0.08375   5.037 2.10e-05 ***\n#> log(infra)       0.24988    0.07807   3.201  0.00323 ** \n#> log(revenue)     0.53807    0.15207   3.538  0.00133 ** \n#> ---\n#> Signif. codes:  \n#> 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 0.4094 on 30 degrees of freedom\n#> Multiple R-squared:  0.8883, Adjusted R-squared:  0.8771 \n#> F-statistic: 79.53 on 3 and 30 DF,  p-value: 2.226e-14"},{"path":"spatial-regression.html","id":"weight-matrix","chapter":"2 Spatial Regression","heading":"2.2.2 Weight Matrix","text":"","code":"\nmigrasi <- read_excel(\"Data/Bab6/matriks migrasi.xlsx\", sheet = 2, col_names = FALSE)\n#> New names:\n#> • `` -> `...1`\n#> • `` -> `...2`\n#> • `` -> `...3`\n#> • `` -> `...4`\n#> • `` -> `...5`\n#> • `` -> `...6`\n#> • `` -> `...7`\n#> • `` -> `...8`\n#> • `` -> `...9`\n#> • `` -> `...10`\n#> • `` -> `...11`\n#> • `` -> `...12`\n#> • `` -> `...13`\n#> • `` -> `...14`\n#> • `` -> `...15`\n#> • `` -> `...16`\n#> • `` -> `...17`\n#> • `` -> `...18`\n#> • `` -> `...19`\n#> • `` -> `...20`\n#> • `` -> `...21`\n#> • `` -> `...22`\n#> • `` -> `...23`\n#> • `` -> `...24`\n#> • `` -> `...25`\n#> • `` -> `...26`\n#> • `` -> `...27`\n#> • `` -> `...28`\n#> • `` -> `...29`\n#> • `` -> `...30`\n#> • `` -> `...31`\n#> • `` -> `...32`\n#> • `` -> `...33`\n#> • `` -> `...34`\nmigrasi = as.matrix(migrasi)\nW.migrasi = mat2listw(migrasi)\n#> Warning in mat2listw(migrasi): style is M (missing); style\n#> should be set to a valid value"},{"path":"spatial-regression.html","id":"moran-test-and-plot","chapter":"2 Spatial Regression","heading":"2.2.3 Moran Test and Plot","text":"","code":"\nmoran.lm = lm.morantest(ols, W.migrasi)\nmoran.lm\n#> \n#>  Global Moran I for regression residuals\n#> \n#> data:  \n#> model: lm(formula = model1, data = provinsi)\n#> weights: W.migrasi\n#> \n#> Moran I statistic standard deviate = 3.4669, p-value\n#> = 0.0002632\n#> alternative hypothesis: greater\n#> sample estimates:\n#> Observed Moran I      Expectation         Variance \n#>      0.213239417     -0.048308437      0.005691365\nmoran.plot(ols$residuals, W.migrasi)"},{"path":"spatial-regression.html","id":"lm-test","chapter":"2 Spatial Regression","heading":"2.2.4 LM Test","text":"","code":"\nLM = lm.LMtests(ols, W.migrasi, test=\"all\")\n#> Please update scripts to use lm.RStests in place of lm.LMtests\n#> Warning in lm.RStests(model = model, listw = listw,\n#> zero.policy = zero.policy, : Spatial weights matrix not row\n#> standardized\nLM\n#> \n#>  Rao's score (a.k.a Lagrange multiplier) diagnostics\n#>  for spatial dependence\n#> \n#> data:  \n#> model: lm(formula = model1, data = provinsi)\n#> test weights: listw\n#> \n#> RSerr = 5.4456, df = 1, p-value = 0.01962\n#> \n#> \n#>  Rao's score (a.k.a Lagrange multiplier) diagnostics\n#>  for spatial dependence\n#> \n#> data:  \n#> model: lm(formula = model1, data = provinsi)\n#> test weights: listw\n#> \n#> RSlag = 3.2163, df = 1, p-value = 0.07291\n#> \n#> \n#>  Rao's score (a.k.a Lagrange multiplier) diagnostics\n#>  for spatial dependence\n#> \n#> data:  \n#> model: lm(formula = model1, data = provinsi)\n#> test weights: listw\n#> \n#> adjRSerr = 3.0702, df = 1, p-value = 0.07974\n#> \n#> \n#>  Rao's score (a.k.a Lagrange multiplier) diagnostics\n#>  for spatial dependence\n#> \n#> data:  \n#> model: lm(formula = model1, data = provinsi)\n#> test weights: listw\n#> \n#> adjRSlag = 0.84087, df = 1, p-value = 0.3591\n#> \n#> \n#>  Rao's score (a.k.a Lagrange multiplier) diagnostics\n#>  for spatial dependence\n#> \n#> data:  \n#> model: lm(formula = model1, data = provinsi)\n#> test weights: listw\n#> \n#> SARMA = 6.2865, df = 2, p-value = 0.04314"},{"path":"spatial-regression.html","id":"sar-model","chapter":"2 Spatial Regression","heading":"2.2.5 SAR Model","text":"","code":"\nsar.provinsi = lagsarlm(model1, data=provinsi, W.migrasi)\nsummary(sar.provinsi)\n#> \n#> Call:\n#> lagsarlm(formula = model1, data = provinsi, listw = W.migrasi)\n#> \n#> Residuals:\n#>       Min        1Q    Median        3Q       Max \n#> -0.679482 -0.291161 -0.083437  0.336403  0.808845 \n#> \n#> Type: lag \n#> Coefficients: (asymptotic standard errors) \n#>                 Estimate Std. Error z value  Pr(>|z|)\n#> (Intercept)     1.744150   1.437574  1.2133 0.2250310\n#> log(investment) 0.380784   0.079364  4.7979 1.603e-06\n#> log(infra)      0.207431   0.073675  2.8155 0.0048701\n#> log(revenue)    0.529174   0.136397  3.8797 0.0001046\n#> \n#> Rho: 0.21114, LR test value: 3.0033, p-value: 0.083096\n#> Asymptotic standard error: 0.12002\n#>     z-value: 1.7592, p-value: 0.07854\n#> Wald statistic: 3.0949, p-value: 0.07854\n#> \n#> Log likelihood: -14.24739 for lag model\n#> ML residual variance (sigma squared): 0.13454, (sigma: 0.36679)\n#> Number of observations: 34 \n#> Number of parameters estimated: 6 \n#> AIC: 40.495, (AIC for lm: 41.498)\n#> LM test for residual autocorrelation\n#> test value: 2.5558, p-value: 0.10989"},{"path":"spatial-regression.html","id":"impacts-spillover","chapter":"2 Spatial Regression","heading":"2.2.6 Impacts (Spillover)","text":"","code":"\nimpacts(sar.provinsi, listw=W.migrasi)\n#> Impact measures (lag, exact):\n#>                    Direct   Indirect     Total\n#> log(investment) 0.3831961 0.09950271 0.4826988\n#> log(infra)      0.2087457 0.05420401 0.2629497\n#> log(revenue)    0.5325268 0.13827873 0.6708055"},{"path":"spatial-regression.html","id":"sem-model","chapter":"2 Spatial Regression","heading":"2.2.7 SEM Model","text":"","code":"\nsem.provinsi = errorsarlm(model1, data=provinsi, W.migrasi)\nsummary(sem.provinsi)\n#> \n#> Call:\n#> errorsarlm(formula = model1, data = provinsi, listw = W.migrasi)\n#> \n#> Residuals:\n#>       Min        1Q    Median        3Q       Max \n#> -0.770148 -0.273480 -0.020662  0.325690  0.647156 \n#> \n#> Type: error \n#> Coefficients: (asymptotic standard errors) \n#>                 Estimate Std. Error z value  Pr(>|z|)\n#> (Intercept)     3.831947   0.772493  4.9605 7.031e-07\n#> log(investment) 0.410266   0.072801  5.6354 1.746e-08\n#> log(infra)      0.209178   0.071237  2.9364  0.003321\n#> log(revenue)    0.550807   0.132071  4.1705 3.039e-05\n#> \n#> Lambda: 0.60794, LR test value: 5.1345, p-value: 0.023455\n#> Asymptotic standard error: 0.19219\n#>     z-value: 3.1632, p-value: 0.0015604\n#> Wald statistic: 10.006, p-value: 0.0015604\n#> \n#> Log likelihood: -13.18178 for error model\n#> ML residual variance (sigma squared): 0.11956, (sigma: 0.34577)\n#> Number of observations: 34 \n#> Number of parameters estimated: 6 \n#> AIC: 38.364, (AIC for lm: 41.498)"},{"path":"spatial-regression.html","id":"spatial-panel","chapter":"2 Spatial Regression","heading":"2.3 Spatial Panel","text":"","code":"\nlibrary(readxl)\npaneljateng <- read_excel(\"Data/Bab6/panel jateng.xlsx\")\nhead(paneljateng)\n#> # A tibble: 6 × 8\n#>   Region       Tahun   PDRB     AK    PAD    UMK   IPM NO   \n#>   <chr>        <dbl>  <dbl>  <dbl>  <dbl>  <dbl> <dbl> <chr>\n#> 1 Kab. Cilacap  2011 7.82e7 797518 1.73e5 7.19e5  64.7 01   \n#> 2 Kab. Cilacap  2012 7.97e7 716465 1.97e5 7.73e5  65.7 01   \n#> 3 Kab. Cilacap  2013 8.10e7 729059 2.79e5 8.88e5  66.8 01   \n#> 4 Kab. Cilacap  2014 8.34e7 736247 3.74e5 1.02e6  67.2 01   \n#> 5 Kab. Cilacap  2015 8.88e7 715819 4.10e5 1.20e6  67.8 01   \n#> 6 Kab. Banyum…  2011 2.45e7 761034 1.93e5 7.5 e5  67.4 02"},{"path":"spatial-regression.html","id":"static-panel-regression","chapter":"2 Spatial Regression","heading":"2.3.1 Static Panel Regression","text":"","code":"\nlibrary(plm)\n#> Warning: package 'plm' was built under R version 4.2.3\nmodelpanel = log(PDRB) ~ log(AK) + log(PAD) + log(UMK) + log(IPM)\nfem1 = plm(modelpanel, data=paneljateng, index=c(\"Region\", \"Tahun\"), model=\"within\")\nrem1 = plm(modelpanel, data=paneljateng, index=c(\"Region\", \"Tahun\"), model=\"random\")\nphtest(fem1, rem1)\n#> \n#>  Hausman Test\n#> \n#> data:  modelpanel\n#> chisq = 37.156, df = 4, p-value = 1.673e-07\n#> alternative hypothesis: one model is inconsistent\nlibrary(lmtest)\n#> Loading required package: zoo\n#> Warning: package 'zoo' was built under R version 4.2.3\n#> \n#> Attaching package: 'zoo'\n#> The following objects are masked from 'package:base':\n#> \n#>     as.Date, as.Date.numeric\nbptest(fem1)\n#> \n#>  studentized Breusch-Pagan test\n#> \n#> data:  fem1\n#> BP = 5.8081, df = 4, p-value = 0.2139\npbgtest(fem1)\n#> \n#>  Breusch-Godfrey/Wooldridge test for serial\n#>  correlation in panel models\n#> \n#> data:  modelpanel\n#> chisq = 51.619, df = 5, p-value = 6.458e-10\n#> alternative hypothesis: serial correlation in idiosyncratic errors"},{"path":"spatial-regression.html","id":"depndency-test","chapter":"2 Spatial Regression","heading":"2.3.2 Depndency Test","text":"","code":"\npcdtest(fem1, test=\"lm\")\n#> \n#>  Breusch-Pagan LM test for cross-sectional dependence\n#>  in panels\n#> \n#> data:  log(PDRB) ~ log(AK) + log(PAD) + log(UMK) + log(IPM)\n#> chisq = 1268.3, df = 595, p-value < 2.2e-16\n#> alternative hypothesis: cross-sectional dependence\npcdtest(fem1, test=\"cd\")\n#> \n#>  Pesaran CD test for cross-sectional dependence in\n#>  panels\n#> \n#> data:  log(PDRB) ~ log(AK) + log(PAD) + log(UMK) + log(IPM)\n#> z = 12.724, p-value < 2.2e-16\n#> alternative hypothesis: cross-sectional dependence"},{"path":"spatial-regression.html","id":"maps-visualization","chapter":"2 Spatial Regression","heading":"2.3.3 Maps Visualization","text":"","code":"\njateng.map = st_read('Data/Bab6/peta jateng/Jawa_Tengah.shp')\n#> Reading layer `Jawa_Tengah' from data source \n#>   `D:\\Project\\_2024\\Bookdown Ekonometrika\\ds-econometrics\\Data\\Bab6\\peta jateng\\Jawa_Tengah.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 35 features and 4 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY, XYZ\n#> Bounding box:  xmin: 108.5559 ymin: -8.211962 xmax: 111.6914 ymax: -5.725698\n#> z_range:       zmin: 0 zmax: 0\n#> Geodetic CRS:  WGS 84\njateng2011 = subset(paneljateng,(Tahun==2011))\njateng2011 = merge(jateng.map, jateng2011, by.x=\"KABKOTNO\", by.y=\"NO\")\njateng2011 <- st_make_valid(jateng2011)\nggplot(jateng2011) +\n  geom_sf(aes(fill = PDRB)) +\n  scale_fill_gradientn(colours = brewer.pal(5, \"Blues\"),\n                       values = scales::rescale(seq(min(jateng2011$PDRB), \n                                                    max(jateng2011$PDRB)*1.01, \n                                                    length = 6))) +\n  theme_minimal() +\n  labs(fill = \"PDRB\")\nggplot(jateng2011) +\n  geom_sf(aes(fill = IPM)) +\n  scale_fill_gradientn(colours = brewer.pal(5, \"Greens\"),\n                       values = scales::rescale(seq(min(jateng2011$IPM), \n                                                    max(jateng2011$IPM)*1.01, \n                                                    length = 6))) +\n  theme_minimal() +\n  labs(fill = \"IPM\")"},{"path":"spatial-regression.html","id":"function-for-spatial-panel-evalutation","chapter":"2 Spatial Regression","heading":"2.3.4 Function for Spatial Panel Evalutation","text":"","code":"\ngodf.spml<-function(object, k=2, criterion=c(\"AIC\", \"BIC\"),  ...){\n  s<-summary(object)\n  l<-s$logLik\n  np<- length(coef(s))\n  N<- nrow(s$model)\n  if(criterion==\"AIC\"){\n    aic<- -2*l+k*np\n    names(aic)<-\"AIC\"\n    return(aic)\n  }\n  if(criterion==\"BIC\"){\n    bic<- -2*l+log(N)*np\n    names(bic)<-\"BIC\"\n    if(k!=2){\n      warning(\"parameter <k> not used for BIC\")\n    }\n    return(bic)\n  }\n}"},{"path":"spatial-regression.html","id":"spatial-panel-model-with-contiguity-weight-matrix","chapter":"2 Spatial Regression","heading":"2.3.5 Spatial Panel Model with Contiguity Weight Matrix","text":"","code":"\njateng.map <- st_make_valid(jateng.map)\nlistqueen = poly2nb(jateng.map, queen=TRUE)\nW.queen = nb2listw(listqueen, style=\"W\")\nW.queen\n#> Characteristics of weights list object:\n#> Neighbour list object:\n#> Number of regions: 35 \n#> Number of nonzero links: 148 \n#> Percentage nonzero weights: 12.08163 \n#> Average number of links: 4.228571 \n#> \n#> Weights style: W \n#> Weights constants summary:\n#>    n   nn S0       S1       S2\n#> W 35 1225 35 18.64242 151.0178\n# SAR Model\nsar.fem.contig = spml(modelpanel, data=paneljateng, listw=W.queen, model=\"within\", lag=TRUE, spatial.error=\"none\")\nsar.rem.contig = spml(modelpanel, data=paneljateng, listw=W.queen, model=\"random\", lag=TRUE, spatial.error=\"none\")\nsphtest(sar.fem.contig, sar.rem.contig)\n#> \n#>  Hausman test for spatial models\n#> \n#> data:  modelpanel\n#> chisq = 0.15855, df = 4, p-value = 0.997\n#> alternative hypothesis: one model is inconsistent\ngodf.spml(sar.rem.contig, criterion=\"AIC\")\n#>       AIC \n#> -703.0118\n# SEM Model\nsem.fem.contig = spml(modelpanel, data=paneljateng, listw=W.queen, model=\"within\", lag=FALSE, spatial.error=\"b\")\nsem.rem.contig = spml(modelpanel, data=paneljateng, listw=W.queen, model=\"random\", lag=FALSE, spatial.error=\"b\")\nsphtest(sem.fem.contig, sem.rem.contig)\n#> \n#>  Hausman test for spatial models\n#> \n#> data:  modelpanel\n#> chisq = 5.4546, df = 4, p-value = 0.2438\n#> alternative hypothesis: one model is inconsistent\ngodf.spml(sem.rem.contig, criterion=\"AIC\")\n#>       AIC \n#> -633.5611"},{"path":"spatial-regression.html","id":"spatial-panel-model-with-knn-weight-matrix","chapter":"2 Spatial Regression","heading":"2.3.6 Spatial Panel Model with KNN Weight Matrix","text":"","code":"\n# K-nearest neighbour with 5 neighbour \ncentroids <- st_centroid(jateng.map)\n#> Warning: st_centroid assumes attributes are constant over\n#> geometries\ncoords <- st_coordinates(centroids)\nneighbour = knearneigh(coords, k=5, longlat=T) \nneighbourlist = knn2nb(neighbour)                              \nmat.knn5 = nb2mat(neighbourlist, style=\"W\")                     \nW.knn5 = nb2listw(neighbourlist, style=\"W\")\nW.knn5\n#> Characteristics of weights list object:\n#> Neighbour list object:\n#> Number of regions: 35 \n#> Number of nonzero links: 175 \n#> Percentage nonzero weights: 14.28571 \n#> Average number of links: 5 \n#> Non-symmetric neighbours list\n#> \n#> Weights style: W \n#> Weights constants summary:\n#>    n   nn S0    S1     S2\n#> W 35 1225 35 12.44 144.48\n# SAR Model\nsar.fem.5nn = spml(modelpanel, data=paneljateng, listw=W.knn5, model=\"within\", lag=TRUE, spatial.error=\"none\")\nsar.rem.5nn = spml(modelpanel, data=paneljateng, listw=W.knn5, model=\"random\", lag=TRUE, spatial.error=\"none\")\nsphtest(sar.fem.5nn, sar.rem.5nn)\n#> \n#>  Hausman test for spatial models\n#> \n#> data:  modelpanel\n#> chisq = 0.9208, df = 4, p-value = 0.9216\n#> alternative hypothesis: one model is inconsistent\ngodf.spml(sar.rem.5nn, criterion=\"AIC\")\n#>       AIC \n#> -717.8954\n\n# SEM Model\nsem.fem.5nn = spml(modelpanel, data=paneljateng, listw=W.knn5, model=\"within\", lag=FALSE, spatial.error=\"b\")\nsem.rem.5nn = spml(modelpanel, data=paneljateng, listw=W.knn5, model=\"random\", lag=FALSE, spatial.error=\"b\")\nsphtest(sem.fem.5nn, sem.rem.5nn)\n#> \n#>  Hausman test for spatial models\n#> \n#> data:  modelpanel\n#> chisq = 5.3246, df = 4, p-value = 0.2556\n#> alternative hypothesis: one model is inconsistent\ngodf.spml(sem.rem.5nn, criterion=\"AIC\")\n#>       AIC \n#> -636.4432"},{"path":"spatial-regression.html","id":"best-model","chapter":"2 Spatial Regression","heading":"2.3.7 Best Model","text":"","code":"\nsummary(sar.rem.5nn)\n#> ML panel with spatial lag, random effects \n#> \n#> Call:\n#> spreml(formula = formula, data = data, index = index, w = listw2mat(listw), \n#>     w2 = listw2mat(listw2), lag = lag, errors = errors, cl = cl)\n#> \n#> Residuals:\n#>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n#>    11.2    12.1    12.4    12.4    12.7    14.2 \n#> \n#> Error variance parameters:\n#>     Estimate Std. Error t-value  Pr(>|t|)    \n#> phi   4204.2     1174.1  3.5808 0.0003425 ***\n#> \n#> Spatial autoregressive coefficient:\n#>        Estimate Std. Error t-value  Pr(>|t|)    \n#> lambda 0.750456   0.053411   14.05 < 2.2e-16 ***\n#> \n#> Coefficients:\n#>              Estimate Std. Error t-value Pr(>|t|)   \n#> (Intercept) 1.2042585  0.7177210  1.6779 0.093368 . \n#> log(AK)     0.0474276  0.0241591  1.9631 0.049630 * \n#> log(PAD)    0.0134898  0.0063019  2.1406 0.032306 * \n#> log(UMK)    0.0470068  0.0167872  2.8002 0.005108 **\n#> log(IPM)    0.3633197  0.1772088  2.0502 0.040342 * \n#> ---\n#> Signif. codes:  \n#> 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"spatial-regression.html","id":"impacts-spillovr---only-for-sar-model","chapter":"2 Spatial Regression","heading":"2.3.8 Impacts (Spillovr) - Only for SAR Model","text":"","code":"\n# Direct and Indirect Effect\ntime = length(unique(paneljateng$Tahun))\nsW.5knn = kronecker(Diagonal(time), listw2dgCMatrix(W.knn5))\nset.seed(12345)\ntrMatc = trW(sW.5knn, type=\"mult\")\nimp = impacts(sar.rem.5nn, tr = trMatc, R = 200)\nsummary(imp, zstats=TRUE, short=T)\n#> Impact measures (lag, trace):\n#>              Direct  Indirect      Total\n#> log(AK)  0.05723256 0.1327900 0.19002256\n#> log(PAD) 0.01627868 0.0377695 0.05404818\n#> log(UMK) 0.05672481 0.1316119 0.18833673\n#> log(IPM) 0.43843073 1.0172393 1.45567007\n#> ========================================================\n#> Simulation results ( variance matrix):\n#> ========================================================\n#> Simulated standard errors\n#>              Direct   Indirect      Total\n#> log(AK)  0.02901319 0.08363074 0.10973883\n#> log(PAD) 0.00734999 0.02062104 0.02706686\n#> log(UMK) 0.02147235 0.08000097 0.09848155\n#> log(IPM) 0.22893212 0.65960697 0.86733379\n#> \n#> Simulated z-values:\n#>            Direct Indirect    Total\n#> log(AK)  1.994006 1.693123 1.817494\n#> log(PAD) 2.422577 2.079525 2.242148\n#> log(UMK) 2.675301 1.800563 2.045985\n#> log(IPM) 1.772328 1.503276 1.611045\n#> \n#> Simulated p-values:\n#>          Direct    Indirect Total   \n#> log(AK)  0.0461514 0.090432 0.069142\n#> log(PAD) 0.0154108 0.037569 0.024952\n#> log(UMK) 0.0074662 0.071772 0.040758\n#> log(IPM) 0.0763402 0.132768 0.107170"}]
